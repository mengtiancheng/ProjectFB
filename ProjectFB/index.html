<!DOCTYPE HTML>
<html>
<head>
<title>SAST族谱</title>
<meta http-equiv="Cache-Control" content="no-siteapp" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta charset='utf-8' />
<link rel="stylesheet" type="text/css" href="./Public/css/style.css">
<script type="text/javascript" src="./Public/js/jquery-1.7.2.min.js"></script>
</head>
<body>
<div id="kuang">
	<img class="fpic" src="./Public/img/kuang.png">
	<div id="neikuang">
		<div id="xiaokuang">
			<div id="fenmian1">
				<img src="./Public/img/fenmian1.png">
			</div>
			<div id="fenmian2">
				<img src="./Public/img/fenmian2.png">
			</div>
		</div>
		<div id="bmlist">
			<div id="bmlistkuang">
				<div  id="hexagon0">
				<div class="outer first liu" ><div  class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">
						<img id="sast" src="./Public/img/sast.png">
					</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon1">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">主席团</div>
				</div></div></div>

				</div>
				<div class="hexagon" id="hexagon2">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">计算机部</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon3">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">电子部</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon4">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">网络部</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon5">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">办公室</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon6">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">科宣部</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon7">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">外联部</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon8">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">社团发展部</div>
				</div></div></div>
				</div>
				<div class="hexagon" id="hexagon9">
				<div class="outer first liu" ><div class="outer second liu" ><div class="outer third liu" >
					<div class="inner" style="background-image:url()">SAST工作室</div>
				</div></div></div>
				</div>

		</div>
		<div id="rwlistkuang">
				<div id="rwkuang" style="background-image:url(./Public/img/rwkuang.png)">
					<div id="rwfy1" style="background-image:url(./Public/img/rwfy.png)">
						<span class="yeartext">2015</span>
					</div>
					<div id="rwfy2" style="background-image:url(./Public/img/rwfy.png)"></div>
					<div id="rwfy3" style="background-image:url(./Public/img/rwfy.png)"></div>
					<div id="rwfy4" style="background-image:url(./Public/img/rwfy.png)"></div>
					<div id="rwfy5" style="background-image:url(./Public/img/rwfy.png)"></div>
					<div id="rwfy6" style="background-image:url(./Public/img/rwfy.png)"></div>

				</div>
					<div id="return" style="background-image:url(./Public/img/return.png)"></div>
				<div id="people">
					<div  class="hexagonrw rw" id="rw1">
					<div class="outer1 first liu"><div  class="outer1 second liu" ><div class="outer1 third liu" >
						<div class="inner" style="background-image:url()"></div>
					</div></div></div>
					</div>
				</div>
		</div>
		<div id="rwxiangqing">
		<div  id="hexagonrw">
			<div class="outer3 first liu" ><div  class="outer3 second liu" ><div class="outer3 third liu" >
				<div class="inner2" style="background-image:url(./Public/img/sast.png)"></div>
			</div></div>
			</div>
			<div class="rwintro">方傅</div>
			<div class="rwname">方师傅</div>
			</div>

		</div>
	</div>
	</div>

</div>
</body>

<script type="text/javascript">
function coverhide(){
	$("#xiaokuang").unbind("click");
	$("#fenmian1").animate(
	 		 {
			    'top':'-500px',
	 		 },
	 		 1200,
	 		 'linear'
 		 );
		$("#fenmian2").animate(
			{
			    'bottom':'-500px',
			},
			1200,
			'linear',function () {
				$("#xiaokuang").hide();
				$("#hexagon0").bind("click",function(){
					covershow();
				} );
			}
		);
		$("#bmlist").fadeIn(1300);
		$("#bmlistkuang").fadeIn(1300);	
}
function showrwxq(rwid){
	$(".hexagonrw").unbind("click");
	$.get("./admin.php/Ajax/ajax?member=" + rwid ,function(back){
		var arr = back;
		console.log(back); 
		
		$("#rwxiangqing").css("display","inline");
		$("#bmlistkuang").css("opacity","0.5");
		$("#rwxiangqing .inner2").css("background-image",'url("'+back.imgurl+'")');
		$("#hexagonrw").empty();
		$("#hexagonrw").append('<div class="outer3 first liu" ><div  class="outer3 second liu" ><div class="outer3 third liu" ><div class="inner2" style="background-image:url(./upload/'+ arr["imgurl"] +')"></div></div></div></div><div class="rwintro">'+arr["introduce"]+'</div><div class="rwname">'+arr["name"]+'</div>');
		//还要将姓名和简介插入其中，另外写样式
	});
}
function hiderwxq(){
	$("#rwxiangqing").css("display","none");
	$("#bmlistkuang").css("opacity","1");
	$(".hexagonrw").unbind("click");
}
function covershow(){
	$("#hexagon0").unbind("click");
	$("#xiaokuang").show();
		$("#bmlist").fadeOut(1300);
		$("#bmlistkuang").fadeOut(1300);
		$("#fenmian1").animate(
 		 {
		    'top':'0px',
 		 },
 		 1200,
 		 'linear',function(){
 		 	$("#xiaokuang").bind("click",function(){
 		 		coverhide();
 		 	} );
 		 }
		 );
	$("#fenmian2").animate(
		{
		    'bottom':'0px',
		},
		1200,
		'linear');
}
function returnlist(){
	$("#bmlist").animate(
		{
			'top':'0px',
		},
		800
		);
	
}
function listshow(bmid){
	$("#bmlist").animate(
		{
			'top':'-511px',
		},
		800
		);
	$.get('./admin.php/Ajax/ajax?year=latest&department=' + bmid ,function(back){ 
		/*这里首先先获取所点击的是哪个部门，然后发送两个ajax请求，
		一个发送部门代号后获取这个部门哪些年份有数据，将它们列在右边的栏目里面，
		另一个请求这个部门最新一年的人物列表，以及每个人物对应的代号、图片url等，将它们呈现在左边*/
		//我在这里假设我请求得到了14个人物
		var arr = back;
		var num = arr.length;
		$("#people").empty();
		for (var i = 0; i < num; i++) {
			var content = '<div  class="hexagonrw rw" id="rw'+ arr[i]["id"] +'">'+
						'<div class="outer1 first liu"><div  class="outer1 second liu" ><div class="outer1 third liu" >'+
							'<div class="inner1" style="background-image:url(./upload/'+ arr[i]["imgurl"] +')"></div>'+
						'</div></div></div>'+
						'</div>';
			$("#people").append(content);
			line = parseInt(i / 5);
			j = i % 5;
			var t = 1;
			if (j % 2 === 0) {
				t = 0;
			};
			$("#rw"+i).css({
				"top" : "+=" +(line * 220 + t * 110) + "px",
				"left" : "+=" + (190 * j) + "px"
			});
		};
	});
	$.get('./admin.php/Ajax/ajax?department=' + bmid ,function(back){
		var arr = back;
		$("#rwkuang").empty();
		for (var i = 0, len = arr.length; i < len; i++) {
			$("#rwkuang").append('<div id="rwfy'+(i + 1)+'" class="yearlist" style="background-image:url(./Public/img/rwfy.png)"><span class="yeartext">'+arr[i]+'</span></div>');
		};

	});
}
function yearclick(year){ 
	$.get('./admin.php/Ajax/ajax?year='+ year +'&department=' + nowDepartment ,function(back){ 
		/*这里首先先获取所点击的是哪个部门，然后发送两个ajax请求，
		一个发送部门代号后获取这个部门哪些年份有数据，将它们列在右边的栏目里面，
		另一个请求这个部门最新一年的人物列表，以及每个人物对应的代号、图片url等，将它们呈现在左边*/
		//我在这里假设我请求得到了14个人物
		var arr = back;
		var num = arr.length;
		$("#people").empty();
		for (var i = 0; i < num; i++) {
			var content = '<div  class="hexagonrw rw" rwid="'+ arr[i]["id"] +'" id="rw'+ arr[i]["id"] +'">'+
						'<div class="outer1 first liu"><div  class="outer1 second liu" ><div class="outer1 third liu" >'+
							'<div class="inner1" style="background-image:url(./upload/'+ arr[i]["imgurl"] +')"></div>'+
						'</div></div></div>'+
						'</div>';
			$("#people").append(content);
			line = parseInt(i / 5);
			j = i % 5;
			var t = 1;
			if (j % 2 === 0) {
				t = 0;
			};
			$("#rw"+i).css({
				"top" : "+=" +(line * 220 + t * 110) + "px",
				"left" : "+=" + (190 * j) + "px"
			});
		};
	});
}
	var nowDepartment;
	$(".hexagon .inner").bind("click",function(){ 
		var bmid = $(this).parents(".hexagon").attr('id').substr(7);
		nowDepartment = bmid;
		listshow(bmid);
	});
	$("#xiaokuang").bind("click",function(){
		coverhide();
	} );
	$(".hexagonrw").live("click",function(){
		var rmid = $(this).attr("id");
		var rwid = rmid.substr(2);
		showrwxq(rwid);
	} );
	$('#rwxiangqing').bind("click",function(){ 
		hiderwxq();
	});
	$("#return").bind("click",function(){
		returnlist();
	})
	$(".yeartext").live("click",function(){ 
		var year = $(this).text();
		yearclick(year);
	});	
</script>
</html>